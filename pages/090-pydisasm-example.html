<section>
  <h1>Disassembly using
    <code
      class="hljs-title"
      style="font-size: smaller">
      pydisasm
    </code>from
    <a href="https://pypi.org/project/xdis/"
       style="font-size: smaller">
      xdis
    </a>
  </h1>

  <p class="small" line-height="40px">
    <code  class="hljs language-shell";
	   style="width: 800px; font-size: smaller;">
      <span class="hljs-meta prompt_">$</span>
      <span class="hljs-title">pydisasm</span> <span class="hljs-variable">/tmp/five_moved.pyc</span>
    </code>

    <pre class="fragment">
      <code
	data-line-numbers="1-24|2-6|25-27"
	class="hljs language-pyasm"
	style="width: 800px;"># pydisasm version 6.1.0
# Python bytecode 3.8.0 (3413)
# Disassembled from Python 3.8.18 (default, Sep  4 2023, 13:19:52)
# [GCC 12.3.0]
# Timestamp in code: 1708217267 (2024-02-17 19:47:47)
# Source code size mod 2**32: 148 bytes
# Method Name:       &lt;module&gt;
# Filename:          five.py
# Argument count:    0
# Position-only argument count: 0
# Keyword-only arguments: 0
# Number of locals:  0
# Stack size:        2
# Flags:             0x00000040 (NOFREE)
# First Line:        1
# Constants:
#    0: '\nBlackHat Asia Example\n'
#    1: &lt;code object five at 0x7f3f4c3d17c0, file "five.py", line 6&gt;
#    2: 'five'
#    3: None
# Names:
#    0: __doc__
#    1: five
#    2: print
  1:           0 LOAD_CONST           ("\nBlackHat Asia Example\n")
               2 STORE_NAME           (__doc__)

  6:           4 LOAD_CONST           (&lt;code object five at 0x7f3f4c3d17c0, file "five.py", line 6&gt;)
               6 LOAD_CONST           ("five")
               8 MAKE_FUNCTION        (Neither defaults, keyword-only args, annotations, nor closures)
              10 STORE_NAME           (five)

 12:          12 LOAD_NAME            (print)
              14 LOAD_NAME            (five)
              16 CALL_FUNCTION        (0 positional arguments)
              18 CALL_FUNCTION        (1 positional argument)
              20 POP_TOP
              22 LOAD_CONST           (None)
              24 RETURN_VALUE


# Method Name:       five
# Filename:          five.py
# Argument count:    0
# Position-only argument count: 0
# Keyword-only arguments: 0
# Number of locals:  0
# Stack size:        1
# Flags:             0x00000043 (NOFREE | NEWLOCALS | OPTIMIZED)
# First Line:        6
# Constants:
#    0: 'Returns the string five'
#    1: '5'
  8:           0 LOAD_CONST           ("5")
               2 RETURN_VALUE
      </code>
    </pre>
  </p>

  <aside class="notes">
    <div style="color: blue; background-color:
    LightYellow">#/9</div>
    <p>
      The first step in decompilation is extracting a list of bytecode
      <em>instructions</em>, from bytecode bytes. Here, I will use the
      bytecode file that we generated earlier as input. And for
      demonstration purposes, I will use the standalone program,
      "pydisasm", from the cross-version disassembler
      package. <div style="color: blue; background-color:
      LightYellow">[DOWN] #/9 ⟶ #/9/0/0</div>
    </p>

    <p>
      First, you’ll see that, again, as we had in <em>uncompyle6</em>,
      there are comments in orange at the top.  And again, this is
      metadata about the bytecode. <div style="color: blue;
      background-color: LightYellow">[DOWN] #/9/0/0 ⟶ #/9/0/1</div>
    </p>
    <p>
      In fact, <em>this</em> particular metadata is exactly the
      same. For example, the version of bytecode that have here is, as
      before, 3413.
    </p>

    <p>
      Now let’s get to the actual Python bytecode
      instructions... <div style="color: blue; background-color:
      LightYellow">[DOWN] #/9/0/1 ⟶ #/9/0/2</div>
    </p>

    <p>
      I’ll go into this in more detail later. But the main thing to
      note here is that the first two instructions <em>come</em> from
      Line One of the Python source text. Line one is indicated by the
      "one colon:" in white to the left.
    </p>

    <p>
      In the part that is greyed out below the one colon, you may see a "six
      colon:".  That is the beginning of the source text for line 6.
    </p>

    <p>
      Each bytecode instruction consists of an oper-A-SHUN name in
      blue. For example "LOAD_CONST", or "STORE_NAME". The instruction
      is then followed by an optional oper-AND. These are listed in
      parenthesis. <div style="color: blue; background-color:
      LightYellow">[NEXT] #/9/0/2 ⟶ #/10</div>
    </p>

  </aside>
</section>
